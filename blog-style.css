<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ocean View Villa Blog</title>
    <link rel="stylesheet" href="admin/blog-style.css">
    <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
    <style>
        .tools-bar { 
            display: flex; justify-content: center; align-items: center;
            flex-wrap: wrap; gap: 15px; width: fit-content; margin: 15px auto;
        }
        .post-card { margin-bottom: 25px; transition: 0.3s; border-right: 5px solid var(--accent); }
        .post-card:hover { transform: translateY(-5px); }
    </style>
</head>
<body>

    <nav class="master-nav">
        <div class="nav-container">
            <img src="img/logo.png" alt="Logo" class="main-logo">
            <div class="nav-actions">
                <a href="https://oceanviewvillamorocco.com" class="btn-book-nav">Book Now</a>
                <div class="lang-switcher">
                    <select id="langSelect">
                        <option value="ar">ğŸ‡²ğŸ‡¦ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</option>
                        <option value="en">ğŸ‡¬ğŸ‡§ English</option>
                        <option value="fr">ğŸ‡«ğŸ‡· FranÃ§ais</option>
                        <option value="es">ğŸ‡ªğŸ‡¸ EspaÃ±ol</option>
                        <option value="de">ğŸ‡©ğŸ‡ª Deutsch</option>
                        <option value="it">ğŸ‡®ğŸ‡¹ Italiano</option>
                    </select>
                </div>
            </div>
        </div>
        <div class="tools-bar">
            <span class="tool-item">âœ¨</span><span class="tool-item">ğŸ¦†</span><span class="tool-item">ğŸ’µ</span>
            <span class="tool-item">ğŸ’°</span><span class="tool-item">ğŸ–ï¸</span><span class="tool-item">ğŸ£</span>
            <span class="tool-item">ğŸŒŠ</span><span class="tool-item">ğŸŒ¡ï¸</span>
        </div>
    </nav>

    <header class="blog-hero">
        <h1>Ø£Ù‡Ù„Ø§Ù‹ Ø¨ÙƒÙ… ÙÙŠ Ø³ÙŠØ¯ÙŠ Ù…ÙˆØ³Ù‰</h1>
        <p>Ø§ÙƒØªØ´Ù Ø£Ø³Ø±Ø§Ø± Ø§Ù„Ù…Ø­ÙŠØ· ÙˆØ­Ø¶Ø§Ø±Ø© Ø¯ÙƒØ§Ù„Ø© Ø¨Ù€ 6 Ù„ØºØ§Øª Ø¹Ø§Ù„Ù…ÙŠØ©</p>
    </header>

    <main id="posts-container">
        <p style="text-align:center; padding: 50px;">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªØ­Ù ÙˆØ§Ù„Ù…Ù‚Ø§Ù„Ø§Øª...</p>
    </main>

    <footer class="main-footer">
        <p>Â© Ocean View Villa Morocco 2026. ÙƒÙ„ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©.</p>
    </footer>

    <script>
        async function loadPosts() {
            const container = document.getElementById('posts-container');
            try {
                const response = await fetch('https://api.github.com/repos/artist-24-7/ocean-view-blog/contents/_posts');
                const files = await response.json();
                if (files.length === 0) {
                    container.innerHTML = '<p style="text-align:center;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù‚Ø§Ù„Ø§Øª Ø­Ø§Ù„ÙŠØ§Ù‹.</p>';
                    return;
                }
                container.innerHTML = ''; 
                for (const file of files) {
                    if (file.name.endsWith('.md')) {
                        const res = await fetch(file.download_url);
                        const text = await res.text();
                        
                        // Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                        const titleMatch = text.match(/title:\s*["']?(.*?)["']?\n/);
                        const imageMatch = text.match(/thumbnail:\s*["']?(.*?)["']?\n/);
                        const title = titleMatch ? titleMatch[1] : 'Ù…Ù‚Ø§Ù„ Ø¬Ø¯ÙŠØ¯';
                        const image = imageMatch ? imageMatch[1] : 'img/default.jpg';
                        
                        // ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ù†Øµ Ù„Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© ÙÙ‚Ø·
                        const cleanText = text.replace(/---[\s\S]*?---/, '').substring(0, 150).trim();

                        const card = document.createElement('div');
                        card.className = 'post-card';
                        card.innerHTML = `
                            <img src="${image}" style="width:100%; height:200px; object-fit:cover;" onerror="this.src='https://via.placeholder.com/400x200?text=Ocean+View'">
                            <div class="post-content">
                                <h2 class="post-title">${title}</h2>
                                <p style="color: #555; line-height: 1.6;">${cleanText}...</p>
                                <a href="${file.html_url}" style="color:var(--accent); font-weight:bold; text-decoration:none;">Ø¥Ù‚Ø±Ø£ Ø§Ù„Ù…Ø²ÙŠØ¯ â†</a>
                            </div>
                        `;
                        container.appendChild(card);
                    }
                }
            } catch (e) {
                container.innerHTML = '<p style="text-align:center;">Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª.</p>';
            }
        }
        loadPosts();
    </script>
</body>
</html>
